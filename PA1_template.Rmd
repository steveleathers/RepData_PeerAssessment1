---
title: "PA1_template"
author: "Steve Leathers"
date: "December 4, 2014"
output: html_document
---

## Loading and preprocessing the data
```{r}

dataset <- read.csv("activity.csv", stringsAsFactors = FALSE)
dailySteps<-aggregate(steps~date,data=dataset,sum,na.rm=TRUE)
```
## What is mean total number of steps taken per day?
```{r}
mean_raw <- mean(dailySteps$steps, na.rm = TRUE)
median_raw <- median(dailySteps$steps, na.rm=TRUE)
hist(dailySteps$steps)
```
The mean total number of steps taken per day is
```{r}
print(median)
```
## What is the average daily activity pattern?
stepsInterval<-aggregate(steps~interval,data=dataset,mean,na.rm=TRUE)
plot(dataset$interval, dataset$steps, type="l")


## Imputing missing values

There are ```r sum(is.na(dataset$steps))``` missing values.

To fix this, I've replaced all missing values with the average for the interval:

```{r}
interval_to_steps<-function(interval){
    stepsInterval[stepsInterval$interval==interval,]$steps
}
fixedNAs = dataset
count = 0
for(i in 1:nrow(fixedNAs)){
    if(is.na(fixedNAs[i,]$steps)){
        fixedNAs[i,]$steps<-interval_to_steps(fixedNAs[i,]$interval)
        count=count+1
    }
}
```
mean_clean <- mean(fixedNAs$steps)
median_clean <- median(fixedNAs$steps)
hist(fixedNAs$steps)

## Are there differences in activity patterns between weekdays and weekends?

First, let's use the weekdays function to determine what day of the week every measurement takes place in.

fixedNAs$realdate <- weekdays(as.Date(as.character(fixedNAs$date)))

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```
