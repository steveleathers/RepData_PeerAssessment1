---
title: "PA1_template"
author: "Steve Leathers"
date: "December 4, 2014"
output: html_document
---

## Loading and preprocessing the data
```{r}

dataset <- read.csv("activity.csv", stringsAsFactors = FALSE)
dailySteps<-aggregate(steps~date,data=dataset,sum,na.rm=TRUE)
```
## What is mean total number of steps taken per day?
```{r}
mean_raw <- mean(dailySteps$steps, na.rm = TRUE)
median_raw <- median(dailySteps$steps, na.rm=TRUE)
hist(dailySteps$steps)
```
The mean total number of steps taken per day is
```{r}
print(median)
```
## What is the average daily activity pattern?
stepsInterval<-aggregate(steps~interval,data=dataset,mean,na.rm=TRUE)
plot(dataset$interval, dataset$steps, type="l")


## Imputing missing values

There are ```r sum(is.na(dataset$steps))``` missing values.

To fix this, I've replaced all missing values with the average for the interval:

```{r}
interval_to_steps<-function(interval){
    stepsInterval[stepsInterval$interval==interval,]$steps
}
fixedNAs = dataset
count = 0
for(i in 1:nrow(fixedNAs)){
    if(is.na(fixedNAs[i,]$steps)){
        fixedNAs[i,]$steps<-interval_to_steps(fixedNAs[i,]$interval)
        count=count+1
    }
}
```
mean_clean <- mean(fixedNAs$steps)
median_clean <- median(fixedNAs$steps)
hist(fixedNAs$steps)

## Are there differences in activity patterns between weekdays and weekends?

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
